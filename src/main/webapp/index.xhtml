<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="/template/main.xhtml">

	<ui:define name="body">
		<div class="container">
			<div class="col-md-8">
				<h1>Próximos eventos</h1>
				<table id="table-bookmarks" cellpadding="0" cellspacing="0"
					border="0" class="table table-striped"></table>
			</div>
		</div>

		<script src="js/jquery-1.10.2.js"></script>
		<script src="js/bootstrap.js"></script>
		<script src="js/jquery.dataTables.js"></script>
		<script src="js/DT_bootstrap.js"></script>
		<script>
    	function change(data) {
        var r = data.match(/^\s*([0-9]+)\s*-\s*([0-9]+)\s*-\s*([0-9]+)$/);
        return r[3]+"/"+r[2]+"/"+r[1];
    	}
    	
			function montarTabela(dados){
				var oTable = $('#table-bookmarks').dataTable({
	    	    						bRetrieve: true,
	    	    						bFilter: false,
	    	    						bInfo: false,
	    	    						bLengthChange: false,
	    	    						bPaginate: false,
	    	    						bSort: false,
	    	    	        	aoColumns: [
	    		    	    	    {
														"mData" : "id",
														"mRender" : function(data, type, full){
															var retorno = '';
															retorno += '<div class="row">';
															retorno += '<div class="col-md-6">';
															retorno += '<span class="label label-warning">' + change(full.data) + '</span>';
															retorno += '<h3>' + full.nome + '</h3>';
															retorno += '<h5>' + full.local + '</h5>';
															retorno += '</div>';
															retorno += '<div class="col-md-6">';
															retorno += '<div style="float:right;"><button type="button" class="btn btn-info">Detalhes</button> <button type="button" class="btn btn-success">Inscrição</button></div>';
															retorno += '</div>';
															retorno += '</div>';
															return retorno;
														}
			    		    	    	}    	
    	        					],
	 	        						oLanguage : {
	 	        							"sEmptyTable": "Nenhum registro retornado.",
	 	        							"sZeroRecords" : "Nenhum registro retornado.",
	 	        							"sProcessing" : "Carregando ..."
	 	        						}	    	    });
        oTable.fnAddData(dados);
			}

    	$(function(){
    		
    		$.ajax({
    	        type : "GET",
    	        url : "api/evento",
              contentType : "application/json;charset=utf8",
    	        dataType : "json",
    	        success : function(dados) {
    	        	montarTabela(dados);
    	        }
    	  });

			});
	
    </script>
	</ui:define>
</ui:composition>